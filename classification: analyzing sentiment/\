import graphlab

products = graphlab.SFrame("amazon_baby.gl/")

products["word_count"] = graphlab.text_analytics.count_words(products["review"])
selected_words = ['awesome', 'great', 'fantastic', 'amazing', 'love', 'horrible', 'bad', 'terrible', 'awful', 'wow', 'hate']

def word_count(dict, word):
    if word in dict:
        return dict[word]
    else:
        return 0

for word in selected_words:
	products[word] = products['word_count'].apply(lambda x:word_count(x,word))


## Question: 1
print "##### Question 1 #####"
selected_words_count = {}
for word in selected_words:
    selected_words_count[word] = 0

most_frequent = ("", 0)
least_frequent = ("", 100000000)

for word in selected_words:
    selected_words_count[word] = sum(products[word])
    if selected_words_count[word] > most_frequent[1]:
        most_frequent[0] = word
        most_frequent[1] = selected_words_count[word]
    if selected_words_count[word] < least_frequent[1]:
        least_frequent[0] = word
        least_frequent[1] = selected_words_count[word]

print "Most frequent - ", most_frequent[0]
print "Least frequent - ", least_frequent[0]
#Most - great
#Least - wow


## Question: 2
products = products[products['rating'] != 3]
products["sentiment"] = products['rating'] >= 4
train_data,test_data = products.random_split(.8, seed=0)
sentiment_model = graphlab.logistic_classifier.create(train_data, target="sentiment", features=["word_count"], validation_set=test_data)
selected_sentiment_model = graphlab.logistic_classifier.create(train_data, target="sentiment", features=selected_words, validation_set=test_data)
coefficients = selected_sentiment_model["coefficients"].sort("value")
print "##### Question 2 #####"
print "Lowest coefficient", coefficients[0]["name"]
print "Highest coefficient", coefficients[-1]["name"]
#Lowest - terrible
#Highest - love


## Question: 3
print "##### Selected_Sentiment_Model #####"
selected_sentiment_model.evaluate(test_data)
sentiment_model.evaluate(test_data)
